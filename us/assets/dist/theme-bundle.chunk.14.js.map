{"version":3,"sources":["webpack:///./assets/js/theme/search.js","webpack:///./assets/js/theme/common/models/forms.js","webpack:///./assets/js/theme/common/utils/form-utils.js","webpack:///./assets/js/theme/common/utils/url-utils.js","webpack:///./assets/js/theme/catalog.js","webpack:///./assets/js/theme/common/faceted-search.js"],"names":["Search","_CatalogPage","apply","arguments","_proto","prototype","formatCategoryTreeForJSTree","node","_this","nodeData","text","data","id","metadata","state","selected","opened","children","forEach","childNode","push","showProducts","navigate","this","$productListingContainer","removeClass","$facetedSearchContainer","$contentResultsContainer","addClass","$","activateTab","searchData","url","count","urlUtils","replaceParams","page","goToUrl","showContent","$tabToActivate","find","each","idx","tab","$tab","is","removeAttr","attr","onTabChangeWithArrows","event","eventKey","which","$tabsCollection","index","document","activeElement","nextTabIdx","$activeTab","activeTabIdx","lastTabIdx","length","get","focus","trigger","onReady","_this2","compareProducts","context","urls","$searchForm","$categoryTreeContainer","Url","parse","window","location","href","treeData","initFacetedSearch","onSortBySubmit","bind","hooks","on","collapsibleFactory","preventDefault","query","section","validator","initValidation","bindValidation","categoryTree","categoryTreeData","createCategoryTree","selectedCategoryIds","jstree","get_selected","check","remove","_step","_iterator","_createForOfIteratorHelperLoose","done","categoryId","value","input","type","name","append","setTimeout","console","log","loadTreeNodes","cb","_this3","ajax","selectedCategoryId","prefix","headers","BCData","csrf_token","formattedResults","dataNode","$container","_this4","treeOptions","core","themes","icons","checkbox","three_state","plugins","_this5","_this$context","onMinPriceError","onMaxPriceError","minPriceNotEntered","maxPriceNotEntered","onInvalidPrice","$contentListingContainer","$searchHeading","$searchCount","$contentCount","requestOptions","template","productListing","contentListing","sidebar","heading","productCount","contentCount","config","product_results","limit","searchProductsPerPage","showMore","facetedSearch","FacetedSearch","content","html","triggerHandler","animate","scrollTop","validationErrorMessages","$form","nod","submit","$element","add","selector","validate","errorMessage","performCheck","areAll","CatalogPage","forms","email","test","password","notEmpty","inputTagNames","createPasswordValidationErrorTextObject","empty","confirm","mismatch","invalid","onEmptyPasswordErrorText","onConfirmPasswordErrorText","onMismatchPasswordErrorText","onNotValidPasswordErrorText","classifyForm","formSelector","options","$inputs","join","_options$formFieldCla","formFieldClass","__","specificClassName","$input","$formField","parent","tagName","prop","toLowerCase","className","inputType","_includes","_camelCase","_capitalize","classifyInput","insertStateHiddenField","$stateField","stateFieldAttrs","$field","fieldId","match","getFieldId","after","Validators","setEmailValidation","field","errorText","val","setPasswordValidation","passwordSelector","password2Selector","requirements","_ref","isOptional","$password","passwordValidations","result","RegExp","alpha","numeric","minlength","setMinMaxPriceValidation","selectors","priceValidationErrorTexts","errorSelector","fieldsetSelector","maxPriceSelector","minPriceSelector","_priceValidationError","configure","form","preventSubmit","successClass","setMessageOptions","errorSpan","setStateCountryValidation","cleanUpStateValidation","$fieldClassElement","Object","keys","classes","hasClass","getUrl","pathname","search","history","pushState","title","params","param","parsed","hasOwnProperty","format","buildQueryString","queryData","key","out","Array","isArray","ndx","substring","parseQueryParams","i","temp","split","_PageManager","currentTarget","queryParams","serialize","PageManager","defaultOptions","accordionToggleSelector","blockerSelector","clearFacetSelector","componentSelector","facetNavListSelector","priceRangeErrorSelector","priceRangeFieldsetSelector","priceRangeFormSelector","priceRangeMaxPriceSelector","priceRangeMinPriceSelector","showMoreToggleSelector","facetedSearchFilterItems","modal","modalFactory","modalOpen","callback","_extend","collapsedFacets","collapsedFacetItems","initPriceValidator","navList","collapseFacetItems","accordionToggle","collapsible","isCollapsed","targetId","collapseAllFacets","onStateChange","onToggleClick","onAccordionToggle","onClearFacet","onFacetClick","onRangeSubmit","filterFacetItems","bindEvents","refreshView","restoreCollapsedFacets","restoreCollapsedFacetItems","updateView","show","api","getPage","err","hide","Error","customLoadProductSizes","li","proID","forProID","proPrice","discountedPrice","Number","trim","replace","toFixed","utils","product","getById","response","availableSizes","obj","expandFacetItems","$navList","_without","hasMoreResults","_union","toggleFacetItems","getMoreFacetResults","facet","facetUrl","open","list_all","updateContent","close","$items","element","indexOf","expandFacet","$accordionToggle","collapseFacet","expandAllFacets","priceRangeValidator","_this6","_this7","unbindEvents","onPopState","off","stopPropagation","$toggle","$link","toggleClass","urlQueryParams","assign","constants","VALID","decodeURI","reload","currentUrl","URLSearchParams","has","updatedLinkUrl","replaceState"],"mappings":"8oCAYA,IAGqBA,EAAM,SAAAC,GAAA,SAAAD,IAAA,OAAAC,EAAAC,MAAA,KAAAC,YAAA,K,UAAAF,G,EAAAD,G,sEAAA,IAAAI,EAAAJ,EAAAK,UA6UtB,OA7UsBD,EACvBE,4BAAA,SAA4BC,GAAM,IAAAC,EAAA,KACxBC,EAAW,CACbC,KAAMH,EAAKI,KACXC,GAAIL,EAAKM,SAASD,GAClBE,MAAO,CACHC,SAAUR,EAAKQ,WAgBvB,OAZIR,EAAKO,QACLL,EAASK,MAAME,OAAwB,SAAfT,EAAKO,MAC7BL,EAASQ,UAAW,GAGpBV,EAAKU,WACLR,EAASQ,SAAW,GACpBV,EAAKU,SAASC,SAAQ,SAACC,GACnBV,EAASQ,SAASG,KAAKZ,EAAKF,4BAA4Ba,QAIzDV,GACVL,EAEDiB,aAAA,SAAaC,GAaT,QAbiB,IAARA,OAAW,GACpBC,KAAKC,yBAAyBC,YAAY,YAC1CF,KAAKG,wBAAwBD,YAAY,YACzCF,KAAKI,yBAAyBC,SAAS,YAEvCC,EAAE,iCAAiCJ,YAAY,+BAC/CI,EAAE,iCAAiCD,SAAS,iBAE5CC,EAAE,iCAAiCJ,YAAY,iBAC/CI,EAAE,iCAAiCD,SAAS,+BAE5CL,KAAKO,YAAYD,EAAE,kCAEdP,EAAL,CAIA,IAAMS,EAAaF,EAAE,sCAAsClB,OACrDqB,EAAOD,EAAWE,MAAQ,EAAKF,EAAWC,IAAME,IAASC,cAAcJ,EAAWC,IAAK,CACzFI,KAAM,IAGVF,IAASG,QAAQL,KACpB5B,EAEDkC,YAAA,SAAYhB,GAaR,QAbgB,IAARA,OAAW,GACnBC,KAAKI,yBAAyBF,YAAY,YAC1CF,KAAKC,yBAAyBI,SAAS,YACvCL,KAAKG,wBAAwBE,SAAS,YAEtCC,EAAE,iCAAiCJ,YAAY,+BAC/CI,EAAE,iCAAiCD,SAAS,iBAE5CC,EAAE,iCAAiCJ,YAAY,iBAC/CI,EAAE,iCAAiCD,SAAS,+BAE5CL,KAAKO,YAAYD,EAAE,kCAEdP,EAAL,CAIA,IAAMS,EAAaF,EAAE,sCAAsClB,OACrDqB,EAAOD,EAAWE,MAAQ,EAAKF,EAAWC,IAAME,IAASC,cAAcJ,EAAWC,IAAK,CACzFI,KAAM,IAGVF,IAASG,QAAQL,KACpB5B,EAED0B,YAAA,SAAYS,GACgBV,EAAE,2BAA2BW,KAAK,gBAE1CC,MAAK,SAACC,EAAKC,GACvB,IAAMC,EAAOf,EAAEc,GAEf,GAAIC,EAAKC,GAAGN,GAGR,OAFAK,EAAKE,WAAW,iBAChBF,EAAKG,KAAK,iBAAiB,GAI/BH,EAAKG,KAAK,WAAY,MACtBH,EAAKG,KAAK,iBAAiB,OAElC3C,EAED4C,sBAAA,SAAsBC,GAClB,IAAMC,EAAWD,EAAME,MAGvB,GAnGa,KAiGqBD,GAhGpB,KAiGPA,EACP,CAEA,IAAME,EAAkBvB,EAAE,2BAA2BW,KAAK,gBAG1D,MADoF,IAAtDY,EAAgBC,MAAMxB,EAAEyB,SAASC,iBAC/D,CAEA,IAIIC,EAJEC,EAAa5B,EAAE,IAAIyB,SAASC,cAAc3C,IAC1C8C,EAAeN,EAAgBC,MAAMI,GACrCE,EAAaP,EAAgBQ,OAAS,EAG5C,OAAQV,GACR,KAhHa,GAiHTM,EAA8B,IAAjBE,EAAqBC,EAAaD,EAAe,EAC9D,MACJ,KAlHc,GAmHVF,EAAaE,IAAiBC,EAAa,EAAID,EAAe,EAKlE7B,EAAEuB,EAAgBS,IAAIL,IAAaM,QAAQC,QAAQ,YACtD3D,EAED4D,QAAA,WAAU,IAAAC,EAAA,KACNC,YAAgB3C,KAAK4C,QAAQC,MAE7B,IAAMC,EAAcxC,EAAE,+BAChByC,EAAyBD,EAAY7B,KAAK,+BAC1CR,EAAMuC,IAAIC,MAAMC,OAAOC,SAASC,MAAM,GACtCC,EAAW,GACjBrD,KAAKC,yBAA2BK,EAAE,8BAClCN,KAAKG,wBAA0BG,EAAE,6BACjCN,KAAKI,yBAA2BE,EAAE,2BAG9BA,EAAE,kBAAkB+B,OAAS,EAC7BrC,KAAKsD,qBAELtD,KAAKuD,eAAiBvD,KAAKuD,eAAeC,KAAKxD,MAC/CyD,IAAMC,GAAG,mBAAoB1D,KAAKuD,iBAItCI,cAEArD,EAAE,iCAAiCoD,GAAG,SAAS,SAAAhC,GAC3CA,EAAMkC,iBACNlB,EAAK5C,kBAGTQ,EAAE,iCAAiCoD,GAAG,SAAS,SAAAhC,GAC3CA,EAAMkC,iBACNlB,EAAK3B,iBAGTT,EAAE,2BAA2BoD,GAAG,QAAS1D,KAAKyB,uBAEkB,IAA5DzB,KAAKC,yBAAyBgB,KAAK,cAAcoB,QAAsC,YAAtB5B,EAAIoD,MAAMC,QAC3E9D,KAAKe,aAAY,GAEjBf,KAAKF,cAAa,GAGtB,IAAMiE,EAAY/D,KAAKgE,eAAelB,GACjCmB,eAAenB,EAAY7B,KAAK,sBAErCjB,KAAK4C,QAAQsB,aAAavE,SAAQ,SAACX,GAC/BqE,EAASxD,KAAK6C,EAAK3D,4BAA4BC,OAGnDgB,KAAKmE,iBAAmBd,EACxBrD,KAAKoE,mBAAmBrB,GAExBD,EAAYY,GAAG,UAAU,SAAAhC,GACrB,IAAM2C,EAAsBtB,EAAuBuB,SAASC,eAE5D,IAAKR,EAAUS,QACX,OAAO9C,EAAMkC,iBAGjBd,EAAY7B,KAAK,4BAA8BwD,SAE/C,IAAK,IAAuCC,EAA5CC,EAAAC,EAAyBP,KAAmBK,EAAAC,KAAAE,MAAE,KAAnCC,EAAUJ,EAAAK,MACXC,EAAQ1E,EAAE,UAAW,CACvB2E,KAAM,SACNC,KAAM,aACNH,MAAOD,IAGXhC,EAAYqC,OAAOH,OAI3BI,YAAW,WACP9E,EAAE,8BAA8BJ,YAAY,cAC7C,KAEHmF,QAAQC,IAAI,qCACfzG,EAGD0G,cAAA,SAAcvG,EAAMwG,GAAI,IAAAC,EAAA,KACpBnF,EAAEoF,KAAK,CACHjF,IAAK,2BACLrB,KAAM,CACFuG,mBAAoB3G,EAAKK,GACzBuG,OAAQ,YAEZC,QAAS,CACL,eAAgB3C,OAAO4C,QAAU5C,OAAO4C,OAAOC,WAAa7C,OAAO4C,OAAOC,WAAa,MAE5FlB,MAAK,SAAAzF,GACJ,IAAM4G,EAAmB,GAEzB5G,EAAKO,SAAQ,SAACsG,GACVD,EAAiBnG,KAAK4F,EAAK1G,4BAA4BkH,OAG3DT,EAAGQ,OAEVnH,EAEDuF,mBAAA,SAAmB8B,GAAY,IAAAC,EAAA,KACrBC,EAAc,CAChBC,KAAM,CACFjH,KAAM,SAACJ,EAAMwG,GAEO,MAAZxG,EAAKK,GACLmG,EAAGW,EAAKhC,kBAGRgC,EAAKZ,cAAcvG,EAAMwG,IAGjCc,OAAQ,CACJC,OAAO,IAGfC,SAAU,CACNC,aAAa,GAEjBC,QAAS,CACL,aAIRR,EAAW5B,OAAO8B,IACrBvH,EAEDyE,kBAAA,WAAoB,IAAAqD,EAAA,KAEhBC,EAAqG5G,KAAK4C,QAAlGiE,EAAeD,EAAfC,gBAAiBC,EAAeF,EAAfE,gBAAiBC,EAAkBH,EAAlBG,mBAAoBC,EAAkBJ,EAAlBI,mBAAoBC,EAAcL,EAAdK,eAC5EhH,EAA2BK,EAAE,8BAC7B4G,EAA2B5G,EAAE,2BAC7BH,EAA0BG,EAAE,6BAC5B6G,EAAiB7G,EAAE,2BACnB8G,EAAe9G,EAAE,iCACjB+G,EAAgB/G,EAAE,iCAElBgH,EAAiB,CACnBC,SAAU,CACNC,eAAgB,yBAChBC,eAAgB,yBAChBC,QAAS,iBACTC,QAAS,iBACTC,aAAc,uBACdC,aAAc,wBAElBC,OAAQ,CACJC,gBAAiB,CACbC,MAZYhI,KAAK4C,QAAQqF,wBAejCC,SAAU,oBAGdlI,KAAKmI,cAAgB,IAAIC,IAAcd,GAAgB,SAACe,GACpDlB,EAAemB,KAAKD,EAAQV,SAGF,YADd3E,IAAIC,MAAMC,OAAOC,SAASC,MAAM,GACpCS,MAAMC,SACVoD,EAAyBoB,KAAKD,EAAQZ,gBACtCJ,EAAciB,KAAKD,EAAQR,cAC3BlB,EAAK5F,aAAY,KAEjBd,EAAyBqI,KAAKD,EAAQb,gBACtCrH,EAAwBmI,KAAKD,EAAQX,SACrCN,EAAakB,KAAKD,EAAQT,cAC1BjB,EAAK7G,cAAa,IAGtBQ,EAAE,QAAQiI,eAAe,gBAEzBjI,EAAE,cAAckI,QAAQ,CACpBC,UAAW,GACZ,OACJ,CACCC,wBAAyB,CACrB7B,kBACAC,kBACAC,qBACAC,qBACAC,qBAGXpI,EAEDmF,eAAA,SAAe2E,GAMX,OALA3I,KAAK2I,MAAQA,EACb3I,KAAK+D,UAAY6E,YAAI,CACjBC,OAAQF,IAGL3I,MACVnB,EAEDoF,eAAA,SAAe6E,GASX,OARI9I,KAAK+D,WACL/D,KAAK+D,UAAUgF,IAAI,CACfC,SAAUF,EACVG,SAAU,WACVC,aAAcJ,EAAS1J,KAAK,kBAI7BY,MACVnB,EAED2F,MAAA,WACI,QAAIxE,KAAK+D,YACL/D,KAAK+D,UAAUoF,eACRnJ,KAAK+D,UAAUqF,OAAO,WAIpC3K,EA7UsB,CAAS4K,M,kDCWrBC,IA1BD,CACVC,MAAK,SAACxE,GAEF,MADW,aACDyE,KAAKzE,IAQnB0E,SAAQ,SAAC1E,GACL,OAAO/E,KAAK0J,SAAS3E,IASzB2E,SAAQ,SAAC3E,GACL,OAAOA,EAAM1C,OAAS,K,kQClBxBsH,EAAgB,CAClB,QACA,SACA,YAUSC,EAA0C,SAACC,EAAOC,EAASC,EAAUC,GAAO,MAAM,CAC3FC,yBAA0BJ,EAC1BK,2BAA4BJ,EAC5BK,4BAA6BJ,EAC7BK,4BAA6BJ,IA4D1B,SAASK,EAAaC,EAAcC,QAAO,IAAPA,MAAU,IACjD,IAAM5B,EAAQrI,EAAEgK,GACVE,EAAU7B,EAAM1H,KAAK0I,EAAcc,KAAK,OAGGC,EAAPH,EAAlCI,sBAAc,IAAAD,EAAG,aAAYA,EAOrC,OAJAF,EAAQtJ,MAAK,SAAC0J,EAAI5F,IA1DtB,SAAuBA,EAAO2F,GAC1B,IAKIE,EALEC,EAASxK,EAAE0E,GACX+F,EAAaD,EAAOE,OAAO,IAAIL,GAC/BM,EAAUH,EAAOI,KAAK,WAAWC,cAEnCC,EAAeT,EAAc,KAAKM,EAItC,GAAgB,UAAZA,EAAqB,CACrB,IAAMI,EAAYP,EAAOI,KAAK,QAE1BI,IAAW,CAAC,QAAS,WAAY,UAAWD,GAE5CD,EAAeT,EAAc,KAAKY,IAAYF,GAG9CR,EAAoB,GAAGO,EAAYI,IAAaH,GAKjDN,EACF1K,SAAS+K,GACT/K,SAASwK,GAmCVY,CAAczG,EAAO2F,MAGlBhC,EAsBX,SAAS+C,EAAuBC,GAC5B,IACMC,EAAkB,CACpB3G,KAAM,SACNC,KAAM,kBAlBd,SAAoB2G,GAChB,IAAMC,EAAUD,EAAOX,KAAK,QAAQa,MAAM,YAE1C,OAAID,GAA8B,IAAnBA,EAAQzJ,OACZyJ,EAAQ,GAGZ,GAQSE,CAAWL,GAIvB5G,MAAO,KAGX4G,EAAYM,MAAM3L,EAAE,YAAasL,IAGrC,IAAMM,EAAa,CAOfC,mBAAoB,SAACpI,EAAWqI,EAAOC,GAC/BD,GACArI,EAAUgF,IAAI,CACVC,SAAUoD,EACVnD,SAAU,SAACzD,EAAI8G,GAGX9G,EAFe8D,IAAMC,MAAM+C,KAI/BpD,aAAcmD,KAc1BE,sBAAuB,SAACxI,EAAWyI,EAAkBC,EAAmBC,EAAYC,EAEjFC,GAAe,IADd3C,EAAwB0C,EAAxB1C,yBAA0BC,EAA0ByC,EAA1BzC,2BAA4BC,EAA2BwC,EAA3BxC,4BAA6BC,EAA2BuC,EAA3BvC,4BAE7EyC,EAAYvM,EAAEkM,GACdM,EAAsB,CACxB,CACI9D,SAAUwD,EACVvD,SAAU,SAACzD,EAAI8G,GACX,IAAMS,EAAST,EAAIjK,OAEnB,GAAIuK,EACA,OAAOpH,GAAG,GAGdA,EAAGuH,IAEP7D,aAAce,GAElB,CACIjB,SAAUwD,EACVvD,SAAU,SAACzD,EAAI8G,GACX,IAAMS,EAAST,EAAIP,MAAM,IAAIiB,OAAON,EAAaO,SAC1CX,EAAIP,MAAM,IAAIiB,OAAON,EAAaQ,WAClCZ,EAAIjK,QAAUqK,EAAaS,UAGlC,GAAIP,GAA6B,IAAfN,EAAIjK,OAClB,OAAOmD,GAAG,GAGdA,EAAGuH,IAEP7D,aAAckB,GAElB,CACIpB,SAAUyD,EACVxD,SAAU,SAACzD,EAAI8G,GACX,IAAMS,EAAST,EAAIjK,OAEnB,GAAIuK,EACA,OAAOpH,GAAG,GAGdA,EAAGuH,IAEP7D,aAAcgB,GAElB,CACIlB,SAAUyD,EACVxD,SAAU,SAACzD,EAAI8G,GAGX9G,EAFe8G,IAAQO,EAAUP,QAIrCpD,aAAciB,IAItBpG,EAAUgF,IAAI+D,IAalBM,yBAA0B,SAACrJ,EAAWsJ,EAAWC,QAAyB,IAAzBA,MAA4B,IACzE,IACIC,EAKAF,EALAE,cACAC,EAIAH,EAJAG,iBACAlD,EAGA+C,EAHA/C,aACAmD,EAEAJ,EAFAI,iBACAC,EACAL,EADAK,iBAIJC,EAAqGL,EAA7FzG,EAAe8G,EAAf9G,gBAAiBC,EAAe6G,EAAf7G,gBAAiBC,EAAkB4G,EAAlB5G,mBAAoBC,EAAkB2G,EAAlB3G,mBAAoBC,EAAc0G,EAAd1G,eAElFlD,EAAU6J,UAAU,CAChBC,KAAMvD,EACNwD,eAAe,EACfC,aAAc,MAGlBhK,EAAUgF,IAAI,CACVG,aAAcrC,EACdmC,SAAU0E,EACVzE,SAAU,WAAWyE,EAAgB,IAAID,IAG7C1J,EAAUgF,IAAI,CACVG,aAAcpC,EACdkC,SAAUyE,EACVxE,SAAU,WAAWyE,EAAgB,IAAID,IAG7C1J,EAAUgF,IAAI,CACVG,aAAclC,EACdgC,SAAUyE,EACVxE,SAAU,aAGdlF,EAAUgF,IAAI,CACVG,aAAcnC,EACdiC,SAAU0E,EACVzE,SAAU,aAGdlF,EAAUgF,IAAI,CACVG,aAAcjC,EACd+B,SAAU,CAAC0E,EAAkBD,GAC7BxE,SAAU,iBAGdlF,EAAUiK,kBAAkB,CACxBhF,SAAU,CAAC0E,EAAkBD,GAC7BzC,OAAQwC,EACRS,UAAWV,KASnBW,0BAA2B,SAACnK,EAAWqI,EAAOC,GACtCD,GACArI,EAAUgF,IAAI,CACVC,SAAUoD,EACVnD,SAAU,WACVC,aAAcmD,KAS1B8B,uBAAwB,SAAC/B,GACrB,IAAMgC,EAAqB9N,EAAE,eAAgB8L,EAAMhN,KAAK,aAAY,MAEpEiP,OAAOC,KAAK1F,IAAI2F,SAAS5O,SAAQ,SAACoF,GAC1BqJ,EAAmBI,SAAS5F,IAAI2F,QAAQxJ,KACxCqJ,EAAmBlO,YAAY0I,IAAI2F,QAAQxJ,W,mDClT3D,kCAEMpE,EAAW,CACb8N,OAAQ,oBAASvL,OAAOC,SAASuL,SAAWxL,OAAOC,SAASwL,QAE5D7N,QAAS,SAACL,GACNyC,OAAO0L,QAAQC,UAAU,GAAI9M,SAAS+M,MAAOrO,GAC7CH,EAAE4C,QAAQV,QAAQ,gBAGtB5B,cAAe,SAACH,EAAKsO,GACjB,IACIC,EADEC,EAASjM,IAAIC,MAAMxC,GAAK,GAM9B,IAAKuO,KAFLC,EAAON,OAAS,KAEFI,EACNA,EAAOG,eAAeF,KACtBC,EAAOpL,MAAMmL,GAASD,EAAOC,IAIrC,OAAOhM,IAAImM,OAAOF,IAGtBG,iBAAkB,SAACC,GACf,IACIC,EADAC,EAAM,GAEV,IAAKD,KAAOD,EACR,GAAIA,EAAUH,eAAeI,GACzB,GAAIE,MAAMC,QAAQJ,EAAUC,IAAO,CAC/B,IAAII,OAAG,EAEP,IAAKA,KAAOL,EAAUC,GACdD,EAAUC,GAAKJ,eAAeQ,KAC9BH,GAAO,IAAID,EAAG,IAAID,EAAUC,GAAKI,SAIzCH,GAAO,IAAID,EAAG,IAAID,EAAUC,GAKxC,OAAOC,EAAII,UAAU,IAGzBC,iBAAkB,SAACP,GAGf,IAFA,IAAMN,EAAS,GAENc,EAAI,EAAGA,EAAIR,EAAUhN,OAAQwN,IAAK,CACvC,IAAMC,EAAOT,EAAUQ,GAAGE,MAAM,KAE5BD,EAAK,KAAMf,EACPS,MAAMC,QAAQV,EAAOe,EAAK,KAC1Bf,EAAOe,EAAK,IAAIjQ,KAAKiQ,EAAK,IAE1Bf,EAAOe,EAAK,IAAM,CAACf,EAAOe,EAAK,IAAKA,EAAK,IAG7Cf,EAAOe,EAAK,IAAMA,EAAK,GAI/B,OAAOf,IAIApO,Q,iQCnEO,IAED0I,EAAW,SAAA2G,GAAA,SAAA3G,IAAA,OAAA2G,EAAArR,MAAA,KAAAC,YAAA,K,QAU3B,O,EAV2BoR,G,EAAA3G,G,sEAAAA,EAAAvK,UAC5ByE,eAAA,SAAe7B,EAAOuO,GAClB,IAAMxP,EAAMuC,IAAIC,MAAMC,OAAOC,SAASC,MAAM,GACtC8M,EAAc5P,EAAE2P,GAAeE,YAAYJ,MAAM,KAEvDtP,EAAIoD,MAAMqM,EAAY,IAAMA,EAAY,UACjCzP,EAAIoD,MAAMhD,KAEjBa,EAAMkC,iBACNV,OAAOC,SAAWH,IAAImM,OAAO,CAAET,SAAUjO,EAAIiO,SAAUC,OAAQhO,IAASyO,iBAAiB3O,EAAIoD,UAChGwF,EAV2B,CAAS+G,O,gNCOnCC,G,OAAiB,CACrBC,wBACE,6EACFC,gBAAiB,0BACjBC,mBAAoB,0CACpBC,kBAAmB,yBACnBC,qBAAsB,0BACtBC,wBAAyB,wCACzBC,2BAA4B,mCAC5BC,uBAAwB,oBACxBC,2BAA4B,qCAC5BC,2BAA4B,qCAE5BC,uBAAwB,oDACxBC,yBAA0B,yCAC1BC,MAAOC,YAAa,UAAU,GAC9BC,WAAW,IAMPhJ,EAAa,WAqBjB,SAAAA,EAAYd,EAAgB+J,EAAU9G,GAAS,IAAAtL,EAAA,KAE7Ce,KAAKsH,eAAiBA,EACtBtH,KAAKqR,SAAWA,EAChBrR,KAAKuK,QAAU+G,IAAS,GAAIjB,EAAgB9F,GAC5CvK,KAAKuR,gBAAkB,GACvBvR,KAAKwR,oBAAsB,GAG3B7N,cAGA3D,KAAKyR,qBAGLnR,EAAEN,KAAKuK,QAAQmG,sBAAsBxP,MAAK,SAACY,EAAO4P,GAChDzS,EAAK0S,mBAAmBrR,EAAEoR,OAI5BpR,EAAEN,KAAKuK,QAAQ+F,yBAAyBpP,MAAK,SAACY,EAAO8P,GACnD,IACMC,EADmBvR,EAAEsR,GACUxS,KAAK,uBAEtCyS,EAAYC,aACd7S,EAAKsS,gBAAgB1R,KAAKgS,EAAYE,aAM1C3M,YAAW,WACL9E,EAAErB,EAAKsL,QAAQkG,mBAAmBnP,GAAG,YACvCrC,EAAK+S,uBAKThS,KAAKiS,cAAgBjS,KAAKiS,cAAczO,KAAKxD,MAC7CA,KAAKkS,cAAgBlS,KAAKkS,cAAc1O,KAAKxD,MAC7CA,KAAKmS,kBAAoBnS,KAAKmS,kBAAkB3O,KAAKxD,MACrDA,KAAKoS,aAAepS,KAAKoS,aAAa5O,KAAKxD,MAC3CA,KAAKqS,aAAerS,KAAKqS,aAAa7O,KAAKxD,MAC3CA,KAAKsS,cAAgBtS,KAAKsS,cAAc9O,KAAKxD,MAC7CA,KAAKuD,eAAiBvD,KAAKuD,eAAeC,KAAKxD,MAC/CA,KAAKuS,iBAAmBvS,KAAKuS,iBAAiB/O,KAAKxD,MAEnDA,KAAKwS,aAELnN,QAAQC,IAAI,qBAGd,IAAAzG,EAAAuJ,EAAAtJ,UAqbC,OArbDD,EACA4T,YAAA,SAAYpK,GACNA,GACFrI,KAAKqR,SAAShJ,GAIhB1E,cAGA3D,KAAKyR,qBAGLzR,KAAK0S,yBACL1S,KAAK2S,6BAGL3S,KAAKwS,cAGN3T,EAED+T,WAAA,WAAa,IAAAlQ,EAAA,KACXpC,EAAEN,KAAKuK,QAAQgG,iBAAiBsC,OAChCxN,QAAQC,IAAI3E,IAAS8N,UAErBqE,IAAIC,QAAQpS,IAAS8N,SAAUzO,KAAKsH,gBAAgB,SAAC0L,EAAK3K,GAGxD,GAFA/H,EAAEoC,EAAK6H,QAAQgG,iBAAiB0C,OAE5BD,EACF,MAAM,IAAIE,MAAMF,GAIlBtQ,EAAK+P,YAAYpK,OAMpBxJ,EAEDsU,uBAAA,WACqB7S,EAAE,2BACRY,MAAK,SAAU7B,EAAI+T,GAG9B,IAAIC,EAAQ/S,EAAEN,MAAMiB,KAAK,eAAe9B,OACpCmU,EAAWhT,EAAEN,MAAMiB,KAAK,mBAAmB9B,OAC3CoU,EAAWjT,EAAEN,MAAMiB,KAAK,oBAAoB9B,OAC5CqU,GACFC,OAAOF,EAASG,OAAOC,QAAQ,IAAK,KAAOF,OAAO,KAClDG,QAAQ,GAIVtT,EAAE,4BAA8BgT,GAAUhL,KAAK,IAAMkL,GAMrDlT,EAAE,kBAAoB+S,GAAO/K,KAC3B,kIAGFuL,IAAMf,IAAIgB,QAAQC,QAChBV,EACA,CAAE9L,SAAU,gCACZ,SAACyL,EAAKgB,GACJ,GAAIhB,EACF,MAAM,IAAIE,MAAMF,GAIlB,IAAIiB,EAAiB,GACrB3T,EAAE0T,GACC/S,KAAK,gBACLC,MAAK,SAAU2O,EAAGqE,GAEjBD,GACE,+BAAiC3T,EAAEN,MAAMsI,OAAS,cAGxDhI,EAAE,kBAAoB+S,GAAO/K,KAAK2L,UAIzCpV,EAEDsV,iBAAA,SAAiBC,GACf,IAAM/U,EAAK+U,EAAS5S,KAAK,MAGzBxB,KAAKwR,oBAAsB6C,IAAUrU,KAAKwR,oBAAqBnS,IAChER,EAED8S,mBAAA,SAAmByC,GACjB,IAAM/U,EAAK+U,EAAS5S,KAAK,MACnB8S,EAAiBF,EAAShV,KAAK,kBAGnCY,KAAKwR,oBADH8C,EACyBC,IAAQvU,KAAKwR,oBAAqB,CAACnS,IAEnCgV,IAAUrU,KAAKwR,oBAAqBnS,IAElER,EAED2V,iBAAA,SAAiBJ,GACf,IAAM/U,EAAK+U,EAAS5S,KAAK,MAGzB,OAAI8J,IAAWtL,KAAKwR,oBAAqBnS,IACvCW,KAAKyU,oBAAoBL,IAElB,IAGTpU,KAAK2R,mBAAmByC,IAEjB,IACRvV,EAED4V,oBAAA,SAAoBL,GAAU,IAAA3O,EAAA,KACtBiP,EAAQN,EAAShV,KAAK,SACtBuV,EAAWhU,IAAS8N,SA+B1B,OA7BAzO,KAAKuK,QAAQ2G,MAAM0D,OACnB5U,KAAKuK,QAAQ6G,WAAY,EAErBpR,KAAKsH,eAAeY,SACtB4K,IAAIC,QACF4B,EACA,CACEpN,SAAUvH,KAAKsH,eAAeY,SAC9B6G,OAAQ,CACN8F,SAAUH,KAGd,SAAC1B,EAAKgB,GACJ,GAAIhB,EACF,MAAM,IAAIE,MAAMF,GAKlBvN,EAAK8E,QAAQ2G,MAAM4D,cAAcd,OAIrChU,KAAKuK,QAAQ2G,MAAM6D,QACnB/U,KAAKuK,QAAQ6G,WAAY,GAG3BpR,KAAK2R,mBAAmByC,IAEjB,GACRvV,EAED0T,iBAAA,SAAiB7Q,GACf,IAAMsT,EAAS1U,EAAE,iBACXuD,EAAQvD,EAAEoB,EAAMuO,eAAe3D,MAAMnB,cAE3C6J,EAAO9T,MAAK,SAACY,EAAOmT,IAEW,IADhB3U,EAAE2U,GAAS9V,OAAOgM,cACtB+J,QAAQrR,GACfvD,EAAE2U,GAASpC,OAEXvS,EAAE2U,GAAShC,WAGhBpU,EAEDsW,YAAA,SAAYC,GACUA,EAAiBhW,KAAK,uBAE9BwV,QACb/V,EAEDwW,cAAA,SAAcD,GACQA,EAAiBhW,KAAK,uBAE9B2V,SACblW,EAEDmT,kBAAA,WAAoB,IAAA7L,EAAA,KACQ7F,EAAEN,KAAKuK,QAAQ+F,yBAEvBpP,MAAK,SAACY,EAAO8P,GAC7B,IAAMwD,EAAmB9U,EAAEsR,GAE3BzL,EAAKkP,cAAcD,OAEtBvW,EAEDyW,gBAAA,WAAkB,IAAA3O,EAAA,KACUrG,EAAEN,KAAKuK,QAAQ+F,yBAEvBpP,MAAK,SAACY,EAAO8P,GAC7B,IAAMwD,EAAmB9U,EAAEsR,GAE3BjL,EAAKwO,YAAYC,OAIrBvW,EACA4S,mBAAA,WACE,GAAsD,IAAlDnR,EAAEN,KAAKuK,QAAQsG,wBAAwBxO,OAA3C,CAIA,IAAM0B,EAAY6E,cACZyE,EAAY,CAChBE,cAAevN,KAAKuK,QAAQoG,wBAC5BnD,iBAAkBxN,KAAKuK,QAAQqG,2BAC/BtG,aAActK,KAAKuK,QAAQsG,uBAC3BpD,iBAAkBzN,KAAKuK,QAAQuG,2BAC/BpD,iBAAkB1N,KAAKuK,QAAQwG,4BAGjC7E,IAAWkB,yBACTrJ,EACAsJ,EACArN,KAAKuK,QAAQ7B,yBAGf1I,KAAKuV,oBAAsBxR,IAC5BlF,EAED8T,2BAAA,WAA6B,IAAA6C,EAAA,KACTlV,EAAEN,KAAKuK,QAAQmG,sBAGvBxP,MAAK,SAACY,EAAO4P,GACrB,IAAM0C,EAAW9T,EAAEoR,GACbrS,EAAK+U,EAAS5S,KAAK,MACF8J,IAAWkK,EAAKhE,oBAAqBnS,GAG1DmW,EAAK7D,mBAAmByC,GAExBoB,EAAKrB,iBAAiBC,OAG3BvV,EAED6T,uBAAA,WAAyB,IAAA+C,EAAA,KACGnV,EAAEN,KAAKuK,QAAQ+F,yBAEvBpP,MAAK,SAACY,EAAO8P,GAC7B,IAAMwD,EAAmB9U,EAAEsR,GAErBvS,EADc+V,EAAiBhW,KAAK,uBACnB2S,SACAzG,IAAWmK,EAAKlE,gBAAiBlS,GAGtDoW,EAAKJ,cAAcD,GAEnBK,EAAKN,YAAYC,OAGtBvW,EAED2T,WAAA,WAEExS,KAAK0V,eAGLpV,EAAE4C,QAAQQ,GAAG,cAAe1D,KAAKiS,eACjC3R,EAAE4C,QAAQQ,GAAG,WAAY1D,KAAK2V,YAC9BrV,EAAEyB,UAAU2B,GACV,QACA1D,KAAKuK,QAAQyG,uBACbhR,KAAKkS,eAEP5R,EAAEyB,UAAU2B,GACV,qBACA1D,KAAKuK,QAAQ+F,wBACbtQ,KAAKmS,mBAEP7R,EAAEyB,UAAU2B,GACV,QACA1D,KAAKuK,QAAQ0G,yBACbjR,KAAKuS,kBAEPjS,EAAEN,KAAKuK,QAAQiG,oBAAoB9M,GAAG,QAAS1D,KAAKoS,cAGpD3O,IAAMC,GAAG,8BAA+B1D,KAAKqS,cAC7C5O,IAAMC,GAAG,gCAAiC1D,KAAKsS,eAC/C7O,IAAMC,GAAG,mBAAoB1D,KAAKuD,iBACnC1E,EAED6W,aAAA,WAEEpV,EAAE4C,QAAQ0S,IAAI,cAAe5V,KAAKiS,eAClC3R,EAAE4C,QAAQ0S,IAAI,WAAY5V,KAAK2V,YAC/BrV,EAAEyB,UAAU6T,IACV,QACA5V,KAAKuK,QAAQyG,uBACbhR,KAAKkS,eAEP5R,EAAEyB,UAAU6T,IACV,qBACA5V,KAAKuK,QAAQ+F,wBACbtQ,KAAKmS,mBAEP7R,EAAEyB,UAAU6T,IACV,QACA5V,KAAKuK,QAAQ0G,yBACbjR,KAAKuS,kBAEPjS,EAAEN,KAAKuK,QAAQiG,oBAAoBoF,IAAI,QAAS5V,KAAKoS,cAGrD3O,IAAMmS,IAAI,8BAA+B5V,KAAKqS,cAC9C5O,IAAMmS,IAAI,gCAAiC5V,KAAKsS,eAChD7O,IAAMmS,IAAI,mBAAoB5V,KAAKuD,iBACpC1E,EAEDuT,aAAA,SAAa1Q,GACX,IACMjB,EADQH,EAAEoB,EAAMuO,eACJzO,KAAK,QAEvBE,EAAMkC,iBACNlC,EAAMmU,kBAGNlV,IAASG,QAAQL,IAClB5B,EAEDqT,cAAA,SAAcxQ,GACZ,IAAMoU,EAAUxV,EAAEoB,EAAMuO,eAClBmE,EAAW9T,EAAEwV,EAAQtU,KAAK,SAGhCE,EAAMkC,iBAGN5D,KAAKwU,iBAAiBJ,IACvBvV,EAEDwT,aAAA,SAAa3Q,EAAOuO,GAClB,IAAM8F,EAAQzV,EAAE2P,GACVxP,EAAMsV,EAAMvU,KAAK,QAEvBE,EAAMkC,iBAENmS,EAAMC,YAAY,eAGlBrV,IAASG,QAAQL,GAEbT,KAAKuK,QAAQ6G,WACfpR,KAAKuK,QAAQ2G,MAAM6D,SAEtBlW,EAED0E,eAAA,SAAe7B,EAAOuO,GACpB,IAAMxP,EAAMuC,IAAIC,MAAMC,OAAOC,SAASC,MAAM,GACtC8M,EAAc5P,EAAE2P,GAAeE,YAAYJ,MAAM,KAEvDtP,EAAIoD,MAAMqM,EAAY,IAAMA,EAAY,UACjCzP,EAAIoD,MAAMhD,KAGjB,IAAMoV,EAAiB,GACvB5H,OAAO6H,OAAOD,EAAgBxV,EAAIoD,OAElCnC,EAAMkC,iBAENjD,IAASG,QACPkC,IAAImM,OAAO,CACTT,SAAUjO,EAAIiO,SACdC,OAAQhO,IAASyO,iBAAiB6G,OAGvCpX,EAEDyT,cAAA,SAAc5Q,EAAOuO,GAGnB,GAFAvO,EAAMkC,iBAED5D,KAAKuV,oBAAoBnM,OAAOR,IAAIuN,UAAUC,OAAnD,CAIA,IAAM3V,EAAMuC,IAAIC,MAAMC,OAAOC,SAASC,MAAM,GACxC8M,EAAcmG,UAAU/V,EAAE2P,GAAeE,aAAaJ,MAAM,KAGhE,IAAK,IAAMT,KAFXY,EAAcvP,IAASiP,iBAAiBM,GAGlCA,EAAYhB,eAAeI,KAC7B7O,EAAIoD,MAAMyL,GAAOY,EAAYZ,IAKjC,IAAM2G,EAAiB,GACvB5H,OAAO6H,OAAOD,EAAgBxV,EAAIoD,OAElClD,IAASG,QACPkC,IAAImM,OAAO,CACTT,SAAUjO,EAAIiO,SACdC,OAAQhO,IAASyO,iBAAiB6G,QAGvCpX,EAEDoT,cAAA,WAGE,OAAO/O,OAAOC,SAASmT,UACxBzX,EAEDsT,kBAAA,SAAkBzQ,GAChB,IACMmQ,EADmBvR,EAAEoB,EAAMuO,eACI7Q,KAAK,uBACpCC,EAAKwS,EAAYE,SAEnBF,EAAYC,YACd9R,KAAKuR,gBAAkBgD,IAAQvU,KAAKuR,gBAAiB,CAAClS,IAEtDW,KAAKuR,gBAAkB8C,IAAUrU,KAAKuR,gBAAiBlS,IAE1DR,EAED8W,WAAA,WACE,IAAMY,EAAarT,OAAOC,SAASC,KAGnC,IAFqB,IAAIoT,gBAAgBD,GAEvBE,IAAI,QAAS,CAC7B,IAEMC,EAFUpW,EAAE,oBAAoBkB,KAAK,QAEZmS,QADpB,eACgC,UAC3CzQ,OAAO0L,QAAQ+H,aAAa,GAAI5U,SAAS+M,MAAO4H,GAElDpW,EAAE4C,QAAQV,QAAQ,gBACnB4F,EA9fgB,GAigBJA,Q","file":"theme-bundle.chunk.14.js","sourcesContent":["import { hooks,api } from '@bigcommerce/stencil-utils';\nimport CatalogPage from './catalog';\nimport FacetedSearch from './common/faceted-search';\nimport compareProducts from './global/compare-products';\nimport urlUtils from './common/utils/url-utils';\nimport Url from 'url';\nimport collapsibleFactory from './common/collapsible';\nimport 'jstree';\nimport nod from './common/nod';\nimport utils from \"@bigcommerce/stencil-utils\";\n\n\nconst leftArrowKey = 37;\nconst rightArrowKey = 39;\n\nexport default class Search extends CatalogPage {\n    formatCategoryTreeForJSTree(node) {\n        const nodeData = {\n            text: node.data,\n            id: node.metadata.id,\n            state: {\n                selected: node.selected,\n            },\n        };\n\n        if (node.state) {\n            nodeData.state.opened = node.state === 'open';\n            nodeData.children = true;\n        }\n\n        if (node.children) {\n            nodeData.children = [];\n            node.children.forEach((childNode) => {\n                nodeData.children.push(this.formatCategoryTreeForJSTree(childNode));\n            });\n        }\n\n        return nodeData;\n    }\n\n    showProducts(navigate = true) {\n        this.$productListingContainer.removeClass('u-hidden');\n        this.$facetedSearchContainer.removeClass('u-hidden');\n        this.$contentResultsContainer.addClass('u-hidden');\n\n        $('[data-content-results-toggle]').removeClass('navBar-action-color--active');\n        $('[data-content-results-toggle]').addClass('navBar-action');\n\n        $('[data-product-results-toggle]').removeClass('navBar-action');\n        $('[data-product-results-toggle]').addClass('navBar-action-color--active');\n\n        this.activateTab($('[data-product-results-toggle]'));\n\n        if (!navigate) {\n            return;\n        }\n\n        const searchData = $('#search-results-product-count span').data();\n        const url = (searchData.count > 0) ? searchData.url : urlUtils.replaceParams(searchData.url, {\n            page: 1,\n        });\n\n        urlUtils.goToUrl(url);\n    }\n\n    showContent(navigate = true) {\n        this.$contentResultsContainer.removeClass('u-hidden');\n        this.$productListingContainer.addClass('u-hidden');\n        this.$facetedSearchContainer.addClass('u-hidden');\n\n        $('[data-product-results-toggle]').removeClass('navBar-action-color--active');\n        $('[data-product-results-toggle]').addClass('navBar-action');\n\n        $('[data-content-results-toggle]').removeClass('navBar-action');\n        $('[data-content-results-toggle]').addClass('navBar-action-color--active');\n\n        this.activateTab($('[data-content-results-toggle]'));\n\n        if (!navigate) {\n            return;\n        }\n\n        const searchData = $('#search-results-content-count span').data();\n        const url = (searchData.count > 0) ? searchData.url : urlUtils.replaceParams(searchData.url, {\n            page: 1,\n        });\n\n        urlUtils.goToUrl(url);\n    }\n\n    activateTab($tabToActivate) {\n        const $tabsCollection = $('[data-search-page-tabs]').find('[role=\"tab\"]');\n\n        $tabsCollection.each((idx, tab) => {\n            const $tab = $(tab);\n\n            if ($tab.is($tabToActivate)) {\n                $tab.removeAttr('tabindex');\n                $tab.attr('aria-selected', true);\n                return;\n            }\n\n            $tab.attr('tabindex', '-1');\n            $tab.attr('aria-selected', false);\n        });\n    }\n\n    onTabChangeWithArrows(event) {\n        const eventKey = event.which;\n        const isLeftOrRightArrowKeydown = eventKey === leftArrowKey\n            || eventKey === rightArrowKey;\n        if (!isLeftOrRightArrowKeydown) return;\n\n        const $tabsCollection = $('[data-search-page-tabs]').find('[role=\"tab\"]');\n\n        const isActiveElementNotTab = $tabsCollection.index($(document.activeElement)) === -1;\n        if (isActiveElementNotTab) return;\n\n        const $activeTab = $(`#${document.activeElement.id}`);\n        const activeTabIdx = $tabsCollection.index($activeTab);\n        const lastTabIdx = $tabsCollection.length - 1;\n\n        let nextTabIdx;\n        switch (eventKey) {\n        case leftArrowKey:\n            nextTabIdx = activeTabIdx === 0 ? lastTabIdx : activeTabIdx - 1;\n            break;\n        case rightArrowKey:\n            nextTabIdx = activeTabIdx === lastTabIdx ? 0 : activeTabIdx + 1;\n            break;\n        default: break;\n        }\n\n        $($tabsCollection.get(nextTabIdx)).focus().trigger('click');\n    }\n\n    onReady() {\n        compareProducts(this.context.urls);\n\n        const $searchForm = $('[data-advanced-search-form]');\n        const $categoryTreeContainer = $searchForm.find('[data-search-category-tree]');\n        const url = Url.parse(window.location.href, true);\n        const treeData = [];\n        this.$productListingContainer = $('#product-listing-container');\n        this.$facetedSearchContainer = $('#faceted-search-container');\n        this.$contentResultsContainer = $('#search-results-content');\n\n        // Init faceted search\n        if ($('#facetedSearch').length > 0) {\n            this.initFacetedSearch();\n        } else {\n            this.onSortBySubmit = this.onSortBySubmit.bind(this);\n            hooks.on('sortBy-submitted', this.onSortBySubmit);\n        }\n\n        // Init collapsibles\n        collapsibleFactory();\n\n        $('[data-product-results-toggle]').on('click', event => {\n            event.preventDefault();\n            this.showProducts();\n        });\n\n        $('[data-content-results-toggle]').on('click', event => {\n            event.preventDefault();\n            this.showContent();\n        });\n\n        $('[data-search-page-tabs]').on('keyup', this.onTabChangeWithArrows);\n\n        if (this.$productListingContainer.find('li.product').length === 0 || url.query.section === 'content') {\n            this.showContent(false);\n        } else {\n            this.showProducts(false);\n        }\n\n        const validator = this.initValidation($searchForm)\n            .bindValidation($searchForm.find('#search_query_adv'));\n\n        this.context.categoryTree.forEach((node) => {\n            treeData.push(this.formatCategoryTreeForJSTree(node));\n        });\n\n        this.categoryTreeData = treeData;\n        this.createCategoryTree($categoryTreeContainer);\n\n        $searchForm.on('submit', event => {\n            const selectedCategoryIds = $categoryTreeContainer.jstree().get_selected();\n\n            if (!validator.check()) {\n                return event.preventDefault();\n            }\n\n            $searchForm.find('input[name=\"category\\[\\]\"]').remove();\n\n            for (const categoryId of selectedCategoryIds) {\n                const input = $('<input>', {\n                    type: 'hidden',\n                    name: 'category[]',\n                    value: categoryId,\n                });\n\n                $searchForm.append(input);\n            }\n        });\n\n        setTimeout(() => {\n            $('[data-search-aria-message]').removeClass('u-hidden');\n        }, 100);\n\n        console.log(\"Searchhhhhhhhhhhhhhhhhhhhhhhh.js\");\n    }\n\n\n    loadTreeNodes(node, cb) {\n        $.ajax({\n            url: '/remote/v1/category-tree',\n            data: {\n                selectedCategoryId: node.id,\n                prefix: 'category',\n            },\n            headers: {\n                'x-xsrf-token': window.BCData && window.BCData.csrf_token ? window.BCData.csrf_token : '',\n            },\n        }).done(data => {\n            const formattedResults = [];\n\n            data.forEach((dataNode) => {\n                formattedResults.push(this.formatCategoryTreeForJSTree(dataNode));\n            });\n\n            cb(formattedResults);\n        });\n    }\n\n    createCategoryTree($container) {\n        const treeOptions = {\n            core: {\n                data: (node, cb) => {\n                    // Root node\n                    if (node.id === '#') {\n                        cb(this.categoryTreeData);\n                    } else {\n                        // Lazy loaded children\n                        this.loadTreeNodes(node, cb);\n                    }\n                },\n                themes: {\n                    icons: true,\n                },\n            },\n            checkbox: {\n                three_state: false,\n            },\n            plugins: [\n                'checkbox',\n            ],\n        };\n\n        $container.jstree(treeOptions);\n    }\n\n    initFacetedSearch() {\n        // eslint-disable-next-line object-curly-newline\n        const { onMinPriceError, onMaxPriceError, minPriceNotEntered, maxPriceNotEntered, onInvalidPrice } = this.context;\n        const $productListingContainer = $('#product-listing-container');\n        const $contentListingContainer = $('#search-results-content');\n        const $facetedSearchContainer = $('#faceted-search-container');\n        const $searchHeading = $('#search-results-heading');\n        const $searchCount = $('#search-results-product-count');\n        const $contentCount = $('#search-results-content-count');\n        const productsPerPage = this.context.searchProductsPerPage;\n        const requestOptions = {\n            template: {\n                productListing: 'search/product-listing',\n                contentListing: 'search/content-listing',\n                sidebar: 'search/sidebar',\n                heading: 'search/heading',\n                productCount: 'search/product-count',\n                contentCount: 'search/content-count',\n            },\n            config: {\n                product_results: {\n                    limit: productsPerPage,\n                },\n            },\n            showMore: 'search/show-more',\n        };\n\n        this.facetedSearch = new FacetedSearch(requestOptions, (content) => {\n            $searchHeading.html(content.heading);\n\n            const url = Url.parse(window.location.href, true);\n            if (url.query.section === 'content') {\n                $contentListingContainer.html(content.contentListing);\n                $contentCount.html(content.contentCount);\n                this.showContent(false);\n            } else {\n                $productListingContainer.html(content.productListing);\n                $facetedSearchContainer.html(content.sidebar);\n                $searchCount.html(content.productCount);\n                this.showProducts(false);\n            }\n\n            $('body').triggerHandler('compareReset');\n\n            $('html, body').animate({\n                scrollTop: 0,\n            }, 100);\n        }, {\n            validationErrorMessages: {\n                onMinPriceError,\n                onMaxPriceError,\n                minPriceNotEntered,\n                maxPriceNotEntered,\n                onInvalidPrice,\n            },\n        });\n    }\n\n    initValidation($form) {\n        this.$form = $form;\n        this.validator = nod({\n            submit: $form,\n        });\n\n        return this;\n    }\n\n    bindValidation($element) {\n        if (this.validator) {\n            this.validator.add({\n                selector: $element,\n                validate: 'presence',\n                errorMessage: $element.data('errorMessage'),\n            });\n        }\n\n        return this;\n    }\n\n    check() {\n        if (this.validator) {\n            this.validator.performCheck();\n            return this.validator.areAll('valid');\n        }\n\n        return false;\n    }\n}\n","const forms = {\n    email(value) {\n        const re = /^.+@.+\\..+/;\n        return re.test(value);\n    },\n\n    /**\n     * Validates a password field\n     * @param value\n     * @returns {boolean}\n     */\n    password(value) {\n        return this.notEmpty(value);\n    },\n\n    /**\n     * validates if a field is empty\n     * @param value\n     * @returns {boolean}\n     *\n     */\n    notEmpty(value) {\n        return value.length > 0;\n    },\n};\n\nexport default forms;\n","import _ from 'lodash';\nimport nod from '../nod';\nimport forms from '../models/forms';\n\nconst inputTagNames = [\n    'input',\n    'select',\n    'textarea',\n];\n/**\n * Set up Object with Error Messages on Password Validation. Please use messages in mentioned order\n * @param {string} empty defines error text for empty field\n * @param {string} confirm defines error text for empty confirmation field\n * @param {string} mismatch defines error text if confirm passford mismatches passford field\n * @param {string} invalid defines error text for invalid password charaters sequence\n * @return {object} messages or default texts if nothing is providing\n */\nexport const createPasswordValidationErrorTextObject = (empty, confirm, mismatch, invalid) => ({\n    onEmptyPasswordErrorText: empty,\n    onConfirmPasswordErrorText: confirm,\n    onMismatchPasswordErrorText: mismatch,\n    onNotValidPasswordErrorText: invalid,\n});\n\n\n/**\n * Apply class name to an input element on its type\n * @param {object} input\n * @param {string} formFieldClass\n * @return {object} Element itself\n */\nfunction classifyInput(input, formFieldClass) {\n    const $input = $(input);\n    const $formField = $input.parent(`.${formFieldClass}`);\n    const tagName = $input.prop('tagName').toLowerCase();\n\n    let className = `${formFieldClass}--${tagName}`;\n    let specificClassName;\n\n    // Input can be text/checkbox/radio etc...\n    if (tagName === 'input') {\n        const inputType = $input.prop('type');\n\n        if (_.includes(['radio', 'checkbox', 'submit'], inputType)) {\n            // ie: .form-field--checkbox, .form-field--radio\n            className = `${formFieldClass}--${_.camelCase(inputType)}`;\n        } else {\n            // ie: .form-field--input .form-field--inputText\n            specificClassName = `${className}${_.capitalize(inputType)}`;\n        }\n    }\n\n    // Apply class modifier\n    return $formField\n        .addClass(className)\n        .addClass(specificClassName);\n}\n\n/**\n * Apply class name to each input element in a form based on its type\n * @example\n * // Before\n * <form id=\"form\">\n *     <div class=\"form-field\">\n *         <input type=\"text\">\n *     </div>\n *     <div class=\"form-field\">\n *         <select>...</select>\n *     </div>\n * </form>\n *\n * classifyForm('#form', { formFieldClass: 'form-field' });\n *\n * // After\n * <div class=\"form-field form-field--input form-field--inputText\">...</div>\n * <div class=\"form-field form-field--select\">...</div>\n *\n * @param {string|object} formSelector - selector or element\n * @param {object} options\n * @return {jQuery} Element itself\n */\nexport function classifyForm(formSelector, options = {}) {\n    const $form = $(formSelector);\n    const $inputs = $form.find(inputTagNames.join(', '));\n\n    // Obtain options\n    const { formFieldClass = 'form-field' } = options;\n\n    // Classify each input in a form\n    $inputs.each((__, input) => {\n        classifyInput(input, formFieldClass);\n    });\n\n    return $form;\n}\n\n/**\n * Get id from given field\n * @param {object} $field JQuery field object\n * @return {string}\n */\nfunction getFieldId($field) {\n    const fieldId = $field.prop('name').match(/(\\[.*\\])/);\n\n    if (fieldId && fieldId.length !== 0) {\n        return fieldId[0];\n    }\n\n    return '';\n}\n\n/**\n * Insert hidden field after State/Province field\n * @param {object} $stateField JQuery field object\n */\nfunction insertStateHiddenField($stateField) {\n    const fieldId = getFieldId($stateField);\n    const stateFieldAttrs = {\n        type: 'hidden',\n        name: `FormFieldIsText${fieldId}`,\n        value: '1',\n    };\n\n    $stateField.after($('<input />', stateFieldAttrs));\n}\n\nconst Validators = {\n    /**\n     * Sets up a new validation when the form is dirty\n     * @param validator\n     * @param field\n     * @param {string} errorText describes errorMassage on email validation\n     */\n    setEmailValidation: (validator, field, errorText) => {\n        if (field) {\n            validator.add({\n                selector: field,\n                validate: (cb, val) => {\n                    const result = forms.email(val);\n\n                    cb(result);\n                },\n                errorMessage: errorText,\n            });\n        }\n    },\n\n    /**\n     * Validate password fields\n     * @param validator\n     * @param passwordSelector\n     * @param password2Selector\n     * @param requirements\n     * @param {object} errorTextsObject\n     * @param isOptional\n     */\n    setPasswordValidation: (validator, passwordSelector, password2Selector, requirements, {\n        onEmptyPasswordErrorText, onConfirmPasswordErrorText, onMismatchPasswordErrorText, onNotValidPasswordErrorText,\n    }, isOptional) => {\n        const $password = $(passwordSelector);\n        const passwordValidations = [\n            {\n                selector: passwordSelector,\n                validate: (cb, val) => {\n                    const result = val.length;\n\n                    if (isOptional) {\n                        return cb(true);\n                    }\n\n                    cb(result);\n                },\n                errorMessage: onEmptyPasswordErrorText,\n            },\n            {\n                selector: passwordSelector,\n                validate: (cb, val) => {\n                    const result = val.match(new RegExp(requirements.alpha))\n                        && val.match(new RegExp(requirements.numeric))\n                        && val.length >= requirements.minlength;\n\n                    // If optional and nothing entered, it is valid\n                    if (isOptional && val.length === 0) {\n                        return cb(true);\n                    }\n\n                    cb(result);\n                },\n                errorMessage: onNotValidPasswordErrorText,\n            },\n            {\n                selector: password2Selector,\n                validate: (cb, val) => {\n                    const result = val.length;\n\n                    if (isOptional) {\n                        return cb(true);\n                    }\n\n                    cb(result);\n                },\n                errorMessage: onConfirmPasswordErrorText,\n            },\n            {\n                selector: password2Selector,\n                validate: (cb, val) => {\n                    const result = val === $password.val();\n\n                    cb(result);\n                },\n                errorMessage: onMismatchPasswordErrorText,\n            },\n        ];\n\n        validator.add(passwordValidations);\n    },\n\n    /**\n     * Validate password fields\n     * @param {Nod} validator\n     * @param {Object} selectors\n     * @param {string} selectors.errorSelector\n     * @param {string} selectors.fieldsetSelector\n     * @param {string} selectors.formSelector\n     * @param {string} selectors.maxPriceSelector\n     * @param {string} selectors.minPriceSelector\n     */\n    setMinMaxPriceValidation: (validator, selectors, priceValidationErrorTexts = {}) => {\n        const {\n            errorSelector,\n            fieldsetSelector,\n            formSelector,\n            maxPriceSelector,\n            minPriceSelector,\n        } = selectors;\n\n        // eslint-disable-next-line object-curly-newline\n        const { onMinPriceError, onMaxPriceError, minPriceNotEntered, maxPriceNotEntered, onInvalidPrice } = priceValidationErrorTexts;\n\n        validator.configure({\n            form: formSelector,\n            preventSubmit: true,\n            successClass: '_', // KLUDGE: Don't apply success class\n        });\n\n        validator.add({\n            errorMessage: onMinPriceError,\n            selector: minPriceSelector,\n            validate: `min-max:${minPriceSelector}:${maxPriceSelector}`,\n        });\n\n        validator.add({\n            errorMessage: onMaxPriceError,\n            selector: maxPriceSelector,\n            validate: `min-max:${minPriceSelector}:${maxPriceSelector}`,\n        });\n\n        validator.add({\n            errorMessage: maxPriceNotEntered,\n            selector: maxPriceSelector,\n            validate: 'presence',\n        });\n\n        validator.add({\n            errorMessage: minPriceNotEntered,\n            selector: minPriceSelector,\n            validate: 'presence',\n        });\n\n        validator.add({\n            errorMessage: onInvalidPrice,\n            selector: [minPriceSelector, maxPriceSelector],\n            validate: 'min-number:0',\n        });\n\n        validator.setMessageOptions({\n            selector: [minPriceSelector, maxPriceSelector],\n            parent: fieldsetSelector,\n            errorSpan: errorSelector,\n        });\n    },\n\n    /**\n     * Sets up a new validation when the form is dirty\n     * @param validator\n     * @param field\n     */\n    setStateCountryValidation: (validator, field, errorText) => {\n        if (field) {\n            validator.add({\n                selector: field,\n                validate: 'presence',\n                errorMessage: errorText,\n            });\n        }\n    },\n\n    /**\n     * Removes classes from dirty form if previously checked\n     * @param field\n     */\n    cleanUpStateValidation: (field) => {\n        const $fieldClassElement = $((`[data-type=\"${field.data('fieldType')}\"]`));\n\n        Object.keys(nod.classes).forEach((value) => {\n            if ($fieldClassElement.hasClass(nod.classes[value])) {\n                $fieldClassElement.removeClass(nod.classes[value]);\n            }\n        });\n    },\n};\n\nexport { Validators, insertStateHiddenField };\n","import Url from 'url';\n\nconst urlUtils = {\n    getUrl: () => `${window.location.pathname}${window.location.search}`,\n\n    goToUrl: (url) => {\n        window.history.pushState({}, document.title, url);\n        $(window).trigger('statechange');\n    },\n\n    replaceParams: (url, params) => {\n        const parsed = Url.parse(url, true);\n        let param;\n\n        // Let the formatter use the query object to build the new url\n        parsed.search = null;\n\n        for (param in params) {\n            if (params.hasOwnProperty(param)) {\n                parsed.query[param] = params[param];\n            }\n        }\n\n        return Url.format(parsed);\n    },\n\n    buildQueryString: (queryData) => {\n        let out = '';\n        let key;\n        for (key in queryData) {\n            if (queryData.hasOwnProperty(key)) {\n                if (Array.isArray(queryData[key])) {\n                    let ndx;\n\n                    for (ndx in queryData[key]) {\n                        if (queryData[key].hasOwnProperty(ndx)) {\n                            out += `&${key}=${queryData[key][ndx]}`;\n                        }\n                    }\n                } else {\n                    out += `&${key}=${queryData[key]}`;\n                }\n            }\n        }\n\n        return out.substring(1);\n    },\n\n    parseQueryParams: (queryData) => {\n        const params = {};\n\n        for (let i = 0; i < queryData.length; i++) {\n            const temp = queryData[i].split('=');\n\n            if (temp[0] in params) {\n                if (Array.isArray(params[temp[0]])) {\n                    params[temp[0]].push(temp[1]);\n                } else {\n                    params[temp[0]] = [params[temp[0]], temp[1]];\n                }\n            } else {\n                params[temp[0]] = temp[1];\n            }\n        }\n\n        return params;\n    },\n};\n\nexport default urlUtils;\n","import PageManager from './page-manager';\nimport urlUtils from './common/utils/url-utils';\nimport Url from 'url';\n\nexport default class CatalogPage extends PageManager {\n    onSortBySubmit(event, currentTarget) {\n        const url = Url.parse(window.location.href, true);\n        const queryParams = $(currentTarget).serialize().split('=');\n\n        url.query[queryParams[0]] = queryParams[1];\n        delete url.query.page;\n\n        event.preventDefault();\n        window.location = Url.format({ pathname: url.pathname, search: urlUtils.buildQueryString(url.query) });\n    }\n}\n","import { hooks, api } from \"@bigcommerce/stencil-utils\";\nimport _ from \"lodash\";\nimport Url from \"url\";\nimport urlUtils from \"./utils/url-utils\";\nimport modalFactory from \"../global/modal\";\nimport collapsibleFactory from \"./collapsible\";\nimport { Validators } from \"./utils/form-utils\";\nimport nod from \"./nod\";\nimport utils from \"@bigcommerce/stencil-utils\";\nimport carousel from \"./../common/carousel\";\n\nconst defaultOptions = {\n  accordionToggleSelector:\n    \"#facetedSearch .accordion-navigation, #facetedSearch .facetedSearch-toggle\",\n  blockerSelector: \"#facetedSearch .blocker\",\n  clearFacetSelector: \"#facetedSearch .facetedSearch-clearLink\",\n  componentSelector: \"#facetedSearch-navList\",\n  facetNavListSelector: \"#facetedSearch .navList\",\n  priceRangeErrorSelector: \"#facet-range-form .form-inlineMessage\",\n  priceRangeFieldsetSelector: \"#facet-range-form .form-fieldset\",\n  priceRangeFormSelector: \"#facet-range-form\",\n  priceRangeMaxPriceSelector: \"#facet-range-form [name=max_price]\",\n  priceRangeMinPriceSelector: \"#facet-range-form [name=min_price]\",\n  //   showMoreToggleSelector: \"#facetedSearch .accordion-content .toggleLink\",\n  showMoreToggleSelector: \"#facetedSearch #facetedSearch-navList .toggleLink\",\n  facetedSearchFilterItems: \"#facetedSearch-filterItems .form-input\",\n  modal: modalFactory(\"#modal\")[0],\n  modalOpen: false,\n};\n\n/**\n * Faceted search view component\n */\nclass FacetedSearch {\n  /**\n   * @param {object} requestOptions - Object with options for the ajax requests\n   * @param {function} callback - Function to execute after fetching templates\n   * @param {object} options - Configurable options\n   * @example\n   *\n   * let requestOptions = {\n   *      templates: {\n   *          productListing: 'category/product-listing',\n   *          sidebar: 'category/sidebar'\n   *     }\n   * };\n   *\n   * let templatesDidLoad = function(content) {\n   *     $productListingContainer.html(content.productListing);\n   *     $facetedSearchContainer.html(content.sidebar);\n   * };\n   *\n   * let facetedSearch = new FacetedSearch(requestOptions, templatesDidLoad);\n   */\n  constructor(requestOptions, callback, options) {\n    // Private properties\n    this.requestOptions = requestOptions;\n    this.callback = callback;\n    this.options = _.extend({}, defaultOptions, options);\n    this.collapsedFacets = [];\n    this.collapsedFacetItems = [];\n\n    // Init collapsibles\n    collapsibleFactory();\n\n    // Init price validator\n    this.initPriceValidator();\n\n    // Show limited items by default\n    $(this.options.facetNavListSelector).each((index, navList) => {\n      this.collapseFacetItems($(navList));\n    });\n\n    // Mark initially collapsed accordions\n    $(this.options.accordionToggleSelector).each((index, accordionToggle) => {\n      const $accordionToggle = $(accordionToggle);\n      const collapsible = $accordionToggle.data(\"collapsibleInstance\");\n\n      if (collapsible.isCollapsed) {\n        this.collapsedFacets.push(collapsible.targetId);\n      }\n    });\n\n    // Collapse all facets if initially hidden\n    // NOTE: Need to execute after Collapsible gets bootstrapped\n    setTimeout(() => {\n      if ($(this.options.componentSelector).is(\":hidden\")) {\n        this.collapseAllFacets();\n      }\n    });\n\n    // Observe user events\n    this.onStateChange = this.onStateChange.bind(this);\n    this.onToggleClick = this.onToggleClick.bind(this);\n    this.onAccordionToggle = this.onAccordionToggle.bind(this);\n    this.onClearFacet = this.onClearFacet.bind(this);\n    this.onFacetClick = this.onFacetClick.bind(this);\n    this.onRangeSubmit = this.onRangeSubmit.bind(this);\n    this.onSortBySubmit = this.onSortBySubmit.bind(this);\n    this.filterFacetItems = this.filterFacetItems.bind(this);\n\n    this.bindEvents();\n\n    console.log(\"faceted-search.js\");\n  }\n\n  // Public methods\n  refreshView(content) {\n    if (content) {\n      this.callback(content);\n    }\n\n    // Init collapsibles\n    collapsibleFactory();\n\n    // Init price validator\n    this.initPriceValidator();\n\n    // Restore view state\n    this.restoreCollapsedFacets();\n    this.restoreCollapsedFacetItems();\n\n    // Bind events\n    this.bindEvents();\n\n    //console.log(\"display refreshed\");\n  }\n\n  updateView() {\n    $(this.options.blockerSelector).show();\n    console.log(urlUtils.getUrl());\n    //console.log(this.requestOptions);\n    api.getPage(urlUtils.getUrl(), this.requestOptions, (err, content) => {\n      $(this.options.blockerSelector).hide();\n\n      if (err) {\n        throw new Error(err);\n      }\n      // console.log(content);\n      // Refresh view with new content\n      this.refreshView(content);\n\n      // this.customLoadProductSizes();\n      // initialize the slider\n      // $('[data-slick]').slick();\n    });\n  }\n\n  customLoadProductSizes() {\n    var listProducts = $(\".productGrid li.product\");\n    listProducts.each(function (id, li) {\n      // display discounted price\n      //var Product = $(li);\n      var proID = $(this).find(\".ProductIDs\").text();\n      var forProID = $(this).find(\".ProductIDsOnly\").text();\n      var proPrice = $(this).find(\".mainLoadedPrice\").text();\n      var discountedPrice = (\n        Number(proPrice.trim().replace(\"$\", \"\")) * Number(0.9)\n      ).toFixed(2);\n      //console.log(discountedPrice);\n      //console.log(proPrice);\n\n      $(\".discountedPriceCategory-\" + forProID).html(\"$\" + discountedPrice);\n\n      //var Product = $(li);\n      // var proID = $(this).find(\".ProductIDs\").text();\n      // //console.log(proID);\n\n      $(\"#loadQuickView-\" + proID).html(\n        '<div id=\"loaderimage\" class=\"loadingOverlay\" style=\"display: block;position: relative !important; top: 22px!important;\"></div>'\n      );\n      //return;\n      utils.api.product.getById(\n        proID,\n        { template: \"products/quick-view-options\" },\n        (err, response) => {\n          if (err) {\n            throw new Error(err);\n          }\n          // console.log(response);\n          // loop the class\n          var availableSizes = \"\";\n          $(response)\n            .find(\".form-option\")\n            .each(function (i, obj) {\n              //console.log($(this).html());\n              availableSizes +=\n                \"<label class='form-option' >\" + $(this).html() + \"</label>\";\n            });\n\n          $(\"#loadQuickView-\" + proID).html(availableSizes);\n        }\n      );\n    });\n  }\n\n  expandFacetItems($navList) {\n    const id = $navList.attr(\"id\");\n\n    // Remove\n    this.collapsedFacetItems = _.without(this.collapsedFacetItems, id);\n  }\n\n  collapseFacetItems($navList) {\n    const id = $navList.attr(\"id\");\n    const hasMoreResults = $navList.data(\"hasMoreResults\");\n\n    if (hasMoreResults) {\n      this.collapsedFacetItems = _.union(this.collapsedFacetItems, [id]);\n    } else {\n      this.collapsedFacetItems = _.without(this.collapsedFacetItems, id);\n    }\n  }\n\n  toggleFacetItems($navList) {\n    const id = $navList.attr(\"id\");\n\n    // Toggle depending on `collapsed` flag\n    if (_.includes(this.collapsedFacetItems, id)) {\n      this.getMoreFacetResults($navList);\n\n      return true;\n    }\n\n    this.collapseFacetItems($navList);\n\n    return false;\n  }\n\n  getMoreFacetResults($navList) {\n    const facet = $navList.data(\"facet\");\n    const facetUrl = urlUtils.getUrl();\n\n    this.options.modal.open();\n    this.options.modalOpen = true;\n\n    if (this.requestOptions.showMore) {\n      api.getPage(\n        facetUrl,\n        {\n          template: this.requestOptions.showMore,\n          params: {\n            list_all: facet,\n          },\n        },\n        (err, response) => {\n          if (err) {\n            throw new Error(err);\n          }\n\n          //   this.options.modal.open();\n          //   this.options.modalOpen = true;\n          this.options.modal.updateContent(response);\n        }\n      );\n    } else {\n      this.options.modal.close();\n      this.options.modalOpen = false;\n    }\n\n    this.collapseFacetItems($navList);\n\n    return false;\n  }\n\n  filterFacetItems(event) {\n    const $items = $(\".navList-item\");\n    const query = $(event.currentTarget).val().toLowerCase();\n\n    $items.each((index, element) => {\n      const text = $(element).text().toLowerCase();\n      if (text.indexOf(query) !== -1) {\n        $(element).show();\n      } else {\n        $(element).hide();\n      }\n    });\n  }\n\n  expandFacet($accordionToggle) {\n    const collapsible = $accordionToggle.data(\"collapsibleInstance\");\n\n    collapsible.open();\n  }\n\n  collapseFacet($accordionToggle) {\n    const collapsible = $accordionToggle.data(\"collapsibleInstance\");\n\n    collapsible.close();\n  }\n\n  collapseAllFacets() {\n    const $accordionToggles = $(this.options.accordionToggleSelector);\n\n    $accordionToggles.each((index, accordionToggle) => {\n      const $accordionToggle = $(accordionToggle);\n\n      this.collapseFacet($accordionToggle);\n    });\n  }\n\n  expandAllFacets() {\n    const $accordionToggles = $(this.options.accordionToggleSelector);\n\n    $accordionToggles.each((index, accordionToggle) => {\n      const $accordionToggle = $(accordionToggle);\n\n      this.expandFacet($accordionToggle);\n    });\n  }\n\n  // Private methods\n  initPriceValidator() {\n    if ($(this.options.priceRangeFormSelector).length === 0) {\n      return;\n    }\n\n    const validator = nod();\n    const selectors = {\n      errorSelector: this.options.priceRangeErrorSelector,\n      fieldsetSelector: this.options.priceRangeFieldsetSelector,\n      formSelector: this.options.priceRangeFormSelector,\n      maxPriceSelector: this.options.priceRangeMaxPriceSelector,\n      minPriceSelector: this.options.priceRangeMinPriceSelector,\n    };\n\n    Validators.setMinMaxPriceValidation(\n      validator,\n      selectors,\n      this.options.validationErrorMessages\n    );\n\n    this.priceRangeValidator = validator;\n  }\n\n  restoreCollapsedFacetItems() {\n    const $navLists = $(this.options.facetNavListSelector);\n\n    // Restore collapsed state for each facet\n    $navLists.each((index, navList) => {\n      const $navList = $(navList);\n      const id = $navList.attr(\"id\");\n      const shouldCollapse = _.includes(this.collapsedFacetItems, id);\n\n      if (shouldCollapse) {\n        this.collapseFacetItems($navList);\n      } else {\n        this.expandFacetItems($navList);\n      }\n    });\n  }\n\n  restoreCollapsedFacets() {\n    const $accordionToggles = $(this.options.accordionToggleSelector);\n\n    $accordionToggles.each((index, accordionToggle) => {\n      const $accordionToggle = $(accordionToggle);\n      const collapsible = $accordionToggle.data(\"collapsibleInstance\");\n      const id = collapsible.targetId;\n      const shouldCollapse = _.includes(this.collapsedFacets, id);\n\n      if (shouldCollapse) {\n        this.collapseFacet($accordionToggle);\n      } else {\n        this.expandFacet($accordionToggle);\n      }\n    });\n  }\n\n  bindEvents() {\n    // Clean-up\n    this.unbindEvents();\n\n    // DOM events\n    $(window).on(\"statechange\", this.onStateChange);\n    $(window).on(\"popstate\", this.onPopState);\n    $(document).on(\n      \"click\",\n      this.options.showMoreToggleSelector,\n      this.onToggleClick\n    );\n    $(document).on(\n      \"toggle.collapsible\",\n      this.options.accordionToggleSelector,\n      this.onAccordionToggle\n    );\n    $(document).on(\n      \"keyup\",\n      this.options.facetedSearchFilterItems,\n      this.filterFacetItems\n    );\n    $(this.options.clearFacetSelector).on(\"click\", this.onClearFacet);\n\n    // Hooks\n    hooks.on(\"facetedSearch-facet-clicked\", this.onFacetClick);\n    hooks.on(\"facetedSearch-range-submitted\", this.onRangeSubmit);\n    hooks.on(\"sortBy-submitted\", this.onSortBySubmit);\n  }\n\n  unbindEvents() {\n    // DOM events\n    $(window).off(\"statechange\", this.onStateChange);\n    $(window).off(\"popstate\", this.onPopState);\n    $(document).off(\n      \"click\",\n      this.options.showMoreToggleSelector,\n      this.onToggleClick\n    );\n    $(document).off(\n      \"toggle.collapsible\",\n      this.options.accordionToggleSelector,\n      this.onAccordionToggle\n    );\n    $(document).off(\n      \"keyup\",\n      this.options.facetedSearchFilterItems,\n      this.filterFacetItems\n    );\n    $(this.options.clearFacetSelector).off(\"click\", this.onClearFacet);\n\n    // Hooks\n    hooks.off(\"facetedSearch-facet-clicked\", this.onFacetClick);\n    hooks.off(\"facetedSearch-range-submitted\", this.onRangeSubmit);\n    hooks.off(\"sortBy-submitted\", this.onSortBySubmit);\n  }\n\n  onClearFacet(event) {\n    const $link = $(event.currentTarget);\n    const url = $link.attr(\"href\");\n\n    event.preventDefault();\n    event.stopPropagation();\n\n    // Update URL\n    urlUtils.goToUrl(url);\n  }\n\n  onToggleClick(event) {\n    const $toggle = $(event.currentTarget);\n    const $navList = $($toggle.attr(\"href\"));\n\n    // Prevent default\n    event.preventDefault();\n\n    // Toggle visible items\n    this.toggleFacetItems($navList);\n  }\n\n  onFacetClick(event, currentTarget) {\n    const $link = $(currentTarget);\n    const url = $link.attr(\"href\");\n\n    event.preventDefault();\n\n    $link.toggleClass(\"is-selected\");\n\n    // Update URL\n    urlUtils.goToUrl(url);\n\n    if (this.options.modalOpen) {\n      this.options.modal.close();\n    }\n  }\n\n  onSortBySubmit(event, currentTarget) {\n    const url = Url.parse(window.location.href, true);\n    const queryParams = $(currentTarget).serialize().split(\"=\");\n\n    url.query[queryParams[0]] = queryParams[1];\n    delete url.query.page;\n\n    // Url object `query` is not a traditional JavaScript Object on all systems, clone it instead\n    const urlQueryParams = {};\n    Object.assign(urlQueryParams, url.query);\n\n    event.preventDefault();\n\n    urlUtils.goToUrl(\n      Url.format({\n        pathname: url.pathname,\n        search: urlUtils.buildQueryString(urlQueryParams),\n      })\n    );\n  }\n\n  onRangeSubmit(event, currentTarget) {\n    event.preventDefault();\n\n    if (!this.priceRangeValidator.areAll(nod.constants.VALID)) {\n      return;\n    }\n\n    const url = Url.parse(window.location.href, true);\n    let queryParams = decodeURI($(currentTarget).serialize()).split(\"&\");\n    queryParams = urlUtils.parseQueryParams(queryParams);\n\n    for (const key in queryParams) {\n      if (queryParams.hasOwnProperty(key)) {\n        url.query[key] = queryParams[key];\n      }\n    }\n\n    // Url object `query` is not a traditional JavaScript Object on all systems, clone it instead\n    const urlQueryParams = {};\n    Object.assign(urlQueryParams, url.query);\n\n    urlUtils.goToUrl(\n      Url.format({\n        pathname: url.pathname,\n        search: urlUtils.buildQueryString(urlQueryParams),\n      })\n    );\n  }\n\n  onStateChange() {\n    //this.updateView();\n    // reload the page, instead of ajax refresh view\n    return window.location.reload();\n  }\n\n  onAccordionToggle(event) {\n    const $accordionToggle = $(event.currentTarget);\n    const collapsible = $accordionToggle.data(\"collapsibleInstance\");\n    const id = collapsible.targetId;\n\n    if (collapsible.isCollapsed) {\n      this.collapsedFacets = _.union(this.collapsedFacets, [id]);\n    } else {\n      this.collapsedFacets = _.without(this.collapsedFacets, id);\n    }\n  }\n\n  onPopState() {\n    const currentUrl = window.location.href;\n    const searchParams = new URLSearchParams(currentUrl);\n    // If searchParams does not contain a page value then modify url query string to have page=1\n    if (!searchParams.has(\"page\")) {\n      const linkUrl = $(\".pagination-link\").attr(\"href\");\n      const re = /page=[0-9]+/i;\n      const updatedLinkUrl = linkUrl.replace(re, \"page=1\");\n      window.history.replaceState({}, document.title, updatedLinkUrl);\n    }\n    $(window).trigger(\"statechange\");\n  }\n}\n\nexport default FacetedSearch;\n"],"sourceRoot":""}